<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LogCabin: LogCabin::RPC::OpaqueServer Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">LogCabin
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceLogCabin.html">LogCabin</a>      </li>
      <li class="navelem"><a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a>      </li>
      <li class="navelem"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html">OpaqueServer</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">LogCabin::RPC::OpaqueServer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="LogCabin::RPC::OpaqueServer" -->
<p>An <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html" title="An OpaqueServer listens for incoming RPCs over TCP connections.">OpaqueServer</a> listens for incoming RPCs over TCP connections.  
 <a href="classLogCabin_1_1RPC_1_1OpaqueServer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>&gt;</code></p>

<p><a href="classLogCabin_1_1RPC_1_1OpaqueServer-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1BoundListener.html">BoundListener</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A socket that listens on a particular address.  <a href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1BoundListener.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structLogCabin_1_1RPC_1_1OpaqueServer_1_1BoundListenerWithMonitor.html">BoundListenerWithMonitor</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Couples a <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1BoundListener.html" title="A socket that listens on a particular address.">BoundListener</a> with an <a class="el" href="classLogCabin_1_1Event_1_1File_1_1Monitor.html" title="Registers a File handler to be monitored by the Event::Loop.">Event::File::Monitor</a> and destroys them in the right order (monitor first).  <a href="structLogCabin_1_1RPC_1_1OpaqueServer_1_1BoundListenerWithMonitor.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1Handler.html">Handler</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">An interface for handling events generated by an <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html" title="An OpaqueServer listens for incoming RPCs over TCP connections.">OpaqueServer</a>.  <a href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1Handler.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1MessageSocketHandler.html">MessageSocketHandler</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives events from a <a class="el" href="classLogCabin_1_1RPC_1_1MessageSocket.html" title="A MessageSocket is a message-oriented layer on top of a TCP connection.">MessageSocket</a>.  <a href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1MessageSocketHandler.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structLogCabin_1_1RPC_1_1OpaqueServer_1_1SocketWithHandler.html">SocketWithHandler</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Couples a <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1MessageSocketHandler.html" title="Receives events from a MessageSocket.">MessageSocketHandler</a> with a <a class="el" href="classLogCabin_1_1RPC_1_1MessageSocket.html" title="A MessageSocket is a message-oriented layer on top of a TCP connection.">MessageSocket</a> (monitor) and destroys them in the right order (monitor first).  <a href="structLogCabin_1_1RPC_1_1OpaqueServer_1_1SocketWithHandler.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a70b3a545f635ffe31a5e06aa31f379a6">OpaqueServer</a> (<a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1Handler.html">Handler</a> &amp;handler, <a class="el" href="classLogCabin_1_1Event_1_1Loop.html">Event::Loop</a> &amp;<a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#ab2e0da8ed3e967fc08db7cd871fbc3f9">eventLoop</a>, uint32_t <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#acb2edeca2b4c9adaeb9c2d12f78e70d7">maxMessageLength</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a70b3a545f635ffe31a5e06aa31f379a6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a4bc28f1cd088c9dac15a725af4a7ebab">~OpaqueServer</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a4bc28f1cd088c9dac15a725af4a7ebab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#ae8b06de44eef3df7e5f0091ebcc4984e">bind</a> (const <a class="el" href="classLogCabin_1_1RPC_1_1Address.html">Address</a> &amp;listenAddress)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Listen on an address for new client connections.  <a href="#ae8b06de44eef3df7e5f0091ebcc4984e"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#af6a420209e0b12e45ace3b5bd05cc387">OpaqueServer</a> (const <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html">OpaqueServer</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html">OpaqueServer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a251d9f3416ddb5593822f4a6418e824b">operator=</a> (const <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html">OpaqueServer</a> &amp;)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1Handler.html">Handler</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a43457466d16027aeb7bab822cc468107">rpcHandler</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deals with <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServerRPC.html" title="This class represents the server side of a remote procedure call.">OpaqueServerRPC</a> objects that this class creates when it receives a request.  <a href="#a43457466d16027aeb7bab822cc468107"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1Event_1_1Loop.html">Event::Loop</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#ab2e0da8ed3e967fc08db7cd871fbc3f9">eventLoop</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The event loop that is used for non-blocking I/O.  <a href="#ab2e0da8ed3e967fc08db7cd871fbc3f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#acb2edeca2b4c9adaeb9c2d12f78e70d7">maxMessageLength</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum number of bytes to allow per request/response.  <a href="#acb2edeca2b4c9adaeb9c2d12f78e70d7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::unordered_set<br class="typebreak"/>
&lt; std::shared_ptr<br class="typebreak"/>
&lt; <a class="el" href="structLogCabin_1_1RPC_1_1OpaqueServer_1_1SocketWithHandler.html">SocketWithHandler</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a4a5da4248ff93b5d1f9726f5af0c9812">sockets</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Every open socket is referenced here so that it can be cleaned up when this <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html" title="An OpaqueServer listens for incoming RPCs over TCP connections.">OpaqueServer</a> is destroyed.  <a href="#a4a5da4248ff93b5d1f9726f5af0c9812"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1Core_1_1Mutex.html">Core::Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#aea4127f7de6d74ee0f21c7c98e2ffea0">boundListenersMutex</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock to prevent concurrent modification of <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a18bced70dd394238cac7a60fa6abe851" title="A list of listening sockets that each listen on a particular address.">boundListeners</a>.  <a href="#aea4127f7de6d74ee0f21c7c98e2ffea0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::deque<br class="typebreak"/>
&lt; <a class="el" href="structLogCabin_1_1RPC_1_1OpaqueServer_1_1BoundListenerWithMonitor.html">BoundListenerWithMonitor</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a18bced70dd394238cac7a60fa6abe851">boundListeners</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A list of listening sockets that each listen on a particular address.  <a href="#a18bced70dd394238cac7a60fa6abe851"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a5af59d657d441cad39e66b2799c9efe0">OpaqueServerRPC</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServerRPC.html" title="This class represents the server side of a remote procedure call.">OpaqueServerRPC</a> keeps a std::weak_ptr back to its originating ServerMessageSocket.  <a href="#a5af59d657d441cad39e66b2799c9efe0"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>An <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html" title="An OpaqueServer listens for incoming RPCs over TCP connections.">OpaqueServer</a> listens for incoming RPCs over TCP connections. </p>
<p>OpaqueServers can be created from any thread, but they will always run on the thread running the <a class="el" href="classLogCabin_1_1Event_1_1Loop.html" title="This class contains an event loop based on Linux&#39;s epoll interface.">Event::Loop</a>. </p>

<p>Definition at line <a class="el" href="OpaqueServer_8h_source.html#l00051">51</a> of file <a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a70b3a545f635ffe31a5e06aa31f379a6"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::OpaqueServer" ref="a70b3a545f635ffe31a5e06aa31f379a6" args="(Handler &amp;handler, Event::Loop &amp;eventLoop, uint32_t maxMessageLength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a70b3a545f635ffe31a5e06aa31f379a6">LogCabin::RPC::OpaqueServer::OpaqueServer</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1Handler.html">Handler</a> &amp;&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLogCabin_1_1Event_1_1Loop.html">Event::Loop</a> &amp;&#160;</td>
          <td class="paramname"><em>eventLoop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>maxMessageLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>
<p>This object won't actually do anything until <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#ae8b06de44eef3df7e5f0091ebcc4984e" title="Listen on an address for new client connections.">bind()</a> is called. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>Handles inbound RPCs. </td></tr>
    <tr><td class="paramname">eventLoop</td><td><a class="el" href="classLogCabin_1_1Event_1_1Loop.html" title="This class contains an event loop based on Linux&#39;s epoll interface.">Event::Loop</a> that will be used to find out when the underlying socket may be read from or written to without blocking. </td></tr>
    <tr><td class="paramname">maxMessageLength</td><td>The maximum number of bytes to allow per request/response. This exists to limit the amount of buffer space a single <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> can use. Attempting to send longer responses will PANIC; attempting to receive longer requests will disconnect the underlying socket. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="OpaqueServer_8cc_source.html#l00167">167</a> of file <a class="el" href="OpaqueServer_8cc_source.html">OpaqueServer.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a4bc28f1cd088c9dac15a725af4a7ebab"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::~OpaqueServer" ref="a4bc28f1cd088c9dac15a725af4a7ebab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a4bc28f1cd088c9dac15a725af4a7ebab">LogCabin::RPC::OpaqueServer::~OpaqueServer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destructor. </p>
<p><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServerRPC.html" title="This class represents the server side of a remote procedure call.">OpaqueServerRPC</a> objects originating from this <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html" title="An OpaqueServer listens for incoming RPCs over TCP connections.">OpaqueServer</a> may be kept around after this destructor returns; however, they won't actually send replies anymore. </p>

<p>Definition at line <a class="el" href="OpaqueServer_8cc_source.html#l00179">179</a> of file <a class="el" href="OpaqueServer_8cc_source.html">OpaqueServer.cc</a>.</p>

</div>
</div>
<a class="anchor" id="af6a420209e0b12e45ace3b5bd05cc387"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::OpaqueServer" ref="af6a420209e0b12e45ace3b5bd05cc387" args="(const OpaqueServer &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a70b3a545f635ffe31a5e06aa31f379a6">LogCabin::RPC::OpaqueServer::OpaqueServer</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html">OpaqueServer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ae8b06de44eef3df7e5f0091ebcc4984e"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::bind" ref="ae8b06de44eef3df7e5f0091ebcc4984e" args="(const Address &amp;listenAddress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#ae8b06de44eef3df7e5f0091ebcc4984e">LogCabin::RPC::OpaqueServer::bind</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLogCabin_1_1RPC_1_1Address.html">Address</a> &amp;&#160;</td>
          <td class="paramname"><em>listenAddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Listen on an address for new client connections. </p>
<p>You can call this multiple times to listen on multiple addresses. (But if you call this twice with the same address, the second time will always throw an error.) This method is thread-safe. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">listenAddress</td><td>The TCP address on listen for new client connections. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An error message if this was not able to listen on the given address; the empty string otherwise. </dd></dl>

<p>Definition at line <a class="el" href="OpaqueServer_8cc_source.html#l00202">202</a> of file <a class="el" href="OpaqueServer_8cc_source.html">OpaqueServer.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a251d9f3416ddb5593822f4a6418e824b"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::operator=" ref="a251d9f3416ddb5593822f4a6418e824b" args="(const OpaqueServer &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html">OpaqueServer</a>&amp; LogCabin::RPC::OpaqueServer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html">OpaqueServer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="a5af59d657d441cad39e66b2799c9efe0"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::OpaqueServerRPC" ref="a5af59d657d441cad39e66b2799c9efe0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServerRPC.html">OpaqueServerRPC</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServerRPC.html" title="This class represents the server side of a remote procedure call.">OpaqueServerRPC</a> keeps a std::weak_ptr back to its originating ServerMessageSocket. </p>

<p>Definition at line <a class="el" href="OpaqueServer_8h_source.html#l00267">267</a> of file <a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a43457466d16027aeb7bab822cc468107"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::rpcHandler" ref="a43457466d16027aeb7bab822cc468107" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer_1_1Handler.html">Handler</a>&amp; <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a43457466d16027aeb7bab822cc468107">LogCabin::RPC::OpaqueServer::rpcHandler</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deals with <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServerRPC.html" title="This class represents the server side of a remote procedure call.">OpaqueServerRPC</a> objects that this class creates when it receives a request. </p>

<p>Definition at line <a class="el" href="OpaqueServer_8h_source.html#l00225">225</a> of file <a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab2e0da8ed3e967fc08db7cd871fbc3f9"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::eventLoop" ref="ab2e0da8ed3e967fc08db7cd871fbc3f9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Event_1_1Loop.html">Event::Loop</a>&amp; <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#ab2e0da8ed3e967fc08db7cd871fbc3f9">LogCabin::RPC::OpaqueServer::eventLoop</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The event loop that is used for non-blocking I/O. </p>

<p>Definition at line <a class="el" href="OpaqueServer_8h_source.html#l00230">230</a> of file <a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>.</p>

</div>
</div>
<a class="anchor" id="acb2edeca2b4c9adaeb9c2d12f78e70d7"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::maxMessageLength" ref="acb2edeca2b4c9adaeb9c2d12f78e70d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint32_t <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#acb2edeca2b4c9adaeb9c2d12f78e70d7">LogCabin::RPC::OpaqueServer::maxMessageLength</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The maximum number of bytes to allow per request/response. </p>

<p>Definition at line <a class="el" href="OpaqueServer_8h_source.html#l00235">235</a> of file <a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4a5da4248ff93b5d1f9726f5af0c9812"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::sockets" ref="a4a5da4248ff93b5d1f9726f5af0c9812" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;std::shared_ptr&lt;<a class="el" href="structLogCabin_1_1RPC_1_1OpaqueServer_1_1SocketWithHandler.html">SocketWithHandler</a>&gt; &gt; <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a4a5da4248ff93b5d1f9726f5af0c9812">LogCabin::RPC::OpaqueServer::sockets</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Every open socket is referenced here so that it can be cleaned up when this <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html" title="An OpaqueServer listens for incoming RPCs over TCP connections.">OpaqueServer</a> is destroyed. </p>
<p>These are reference-counted: the lifetime of each socket may slightly exceed the lifetime of the <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html" title="An OpaqueServer listens for incoming RPCs over TCP connections.">OpaqueServer</a> if it is being actively used to send out a <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServerRPC.html" title="This class represents the server side of a remote procedure call.">OpaqueServerRPC</a> response when the <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html" title="An OpaqueServer listens for incoming RPCs over TCP connections.">OpaqueServer</a> is destroyed.</p>
<p>This may only be accessed from the <a class="el" href="classLogCabin_1_1Event_1_1Loop.html" title="This class contains an event loop based on Linux&#39;s epoll interface.">Event::Loop</a> or while holding an <a class="el" href="classLogCabin_1_1Event_1_1Loop_1_1Lock.html" title="Lock objects are used to synchronize between the Event::Loop thread and other threads.">Event::Loop::Lock</a> (it's almost entirely accessed from event handlers, so it's convenient to rely on the <a class="el" href="classLogCabin_1_1Event_1_1Loop_1_1Lock.html" title="Lock objects are used to synchronize between the Event::Loop thread and other threads.">Event::Loop::Lock</a> for mutual exclusion during OpauqeServer's destructor as well). </p>

<p>Definition at line <a class="el" href="OpaqueServer_8h_source.html#l00249">249</a> of file <a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>.</p>

</div>
</div>
<a class="anchor" id="aea4127f7de6d74ee0f21c7c98e2ffea0"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::boundListenersMutex" ref="aea4127f7de6d74ee0f21c7c98e2ffea0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Core_1_1Mutex.html">Core::Mutex</a> <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#aea4127f7de6d74ee0f21c7c98e2ffea0">LogCabin::RPC::OpaqueServer::boundListenersMutex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lock to prevent concurrent modification of <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a18bced70dd394238cac7a60fa6abe851" title="A list of listening sockets that each listen on a particular address.">boundListeners</a>. </p>

<p>Definition at line <a class="el" href="OpaqueServer_8h_source.html#l00254">254</a> of file <a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>.</p>

</div>
</div>
<a class="anchor" id="a18bced70dd394238cac7a60fa6abe851"></a><!-- doxytag: member="LogCabin::RPC::OpaqueServer::boundListeners" ref="a18bced70dd394238cac7a60fa6abe851" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::deque&lt;<a class="el" href="structLogCabin_1_1RPC_1_1OpaqueServer_1_1BoundListenerWithMonitor.html">BoundListenerWithMonitor</a>&gt; <a class="el" href="classLogCabin_1_1RPC_1_1OpaqueServer.html#a18bced70dd394238cac7a60fa6abe851">LogCabin::RPC::OpaqueServer::boundListeners</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A list of listening sockets that each listen on a particular address. </p>
<p>std::deque is used so that the handler objects have a stable memory location (otherwise their monitors would blow up). </p>

<p>Definition at line <a class="el" href="OpaqueServer_8h_source.html#l00261">261</a> of file <a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>RPC/<a class="el" href="OpaqueServer_8h_source.html">OpaqueServer.h</a></li>
<li>RPC/<a class="el" href="OpaqueServer_8cc_source.html">OpaqueServer.cc</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
