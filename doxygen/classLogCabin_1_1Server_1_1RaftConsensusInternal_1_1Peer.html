<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LogCabin: LogCabin::Server::RaftConsensusInternal::Peer Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">LogCabin
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceLogCabin.html">LogCabin</a>      </li>
      <li class="navelem"><a class="el" href="namespaceLogCabin_1_1Server.html">Server</a>      </li>
      <li class="navelem"><a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html">RaftConsensusInternal</a>      </li>
      <li class="navelem"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">LogCabin::Server::RaftConsensusInternal::Peer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="LogCabin::Server::RaftConsensusInternal::Peer" --><!-- doxytag: inherits="LogCabin::Server::RaftConsensusInternal::Server" -->
<p>Represents another server in the cluster.  
 <a href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for LogCabin::Server::RaftConsensusInternal::Peer:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.png" usemap="#LogCabin::Server::RaftConsensusInternal::Peer_map" alt=""/>
  <map id="LogCabin::Server::RaftConsensusInternal::Peer_map" name="LogCabin::Server::RaftConsensusInternal::Peer_map">
<area href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s..." alt="LogCabin::Server::RaftConsensusInternal::Server" shape="rect" coords="0,0,288,24"/>
</map>
 </div></div>

<p><a href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ab658a5a52b9183a271843a5279d31ac9">Peer</a> (uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#ac1b2d6d134b4c41baf0220a0c6e587b7">serverId</a>, <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html">RaftConsensus</a> &amp;<a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aab8969e0bf7d7c361908ad13073a6d2d">consensus</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ab658a5a52b9183a271843a5279d31ac9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a33cb93c3fc8e2aefe48e832b46d27b8f">~Peer</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a33cb93c3fc8e2aefe48e832b46d27b8f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aa7a24ef9188194eefe118684d66a2ec5">beginRequestVote</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Begin requesting the <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a>'s vote in the current election.  <a href="#aa7a24ef9188194eefe118684d66a2ec5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad5ba27d28751c0c5c12e3670f7055afd">beginLeadership</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Begin replicating to the <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> in the current term.  <a href="#ad5ba27d28751c0c5c12e3670f7055afd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a46d99021b75d28c44c31cbe4fe221001">exit</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Inform any threads belonging to this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> to exit.  <a href="#a46d99021b75d28c44c31cbe4fe221001"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a2a60ec5adc78780464eff2eaaf625d86">getLastAckEpoch</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the latest time this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> acknowledged our current term.  <a href="#a2a60ec5adc78780464eff2eaaf625d86"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a74f6a5c2c9950c94cf61c1c302f9d84f">getLastAgreeIndex</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the largest entry ID for which this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> is known to share the same entries up to and including this entry with our log.  <a href="#a74f6a5c2c9950c94cf61c1c302f9d84f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a31e4de7206ec311e2bd8e9f912a284d0">haveVote</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> has awarded us its vote for this term.  <a href="#a31e4de7206ec311e2bd8e9f912a284d0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a81973f60b1302672c5d0c582a4638f4b">isCaughtUp</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true once this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> is ready to be added to the cluster.  <a href="#a81973f60b1302672c5d0c582a4638f4b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a5daf374d78d59b74c639acef42f8b1e5">interrupt</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel any outstanding RPCs to this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a>.  <a href="#a5daf374d78d59b74c639acef42f8b1e5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a8cf12a4c6290d1ea99c3e4074fced205">scheduleHeartbeat</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the next heartbeat <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> happen soon.  <a href="#a8cf12a4c6290d1ea99c3e4074fced205"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad7c0b6afed998a197d4a538e6a56e589">callRPC</a> (Protocol::Raft::OpCode opCode, const google::protobuf::Message &amp;request, google::protobuf::Message &amp;response, std::unique_lock&lt; <a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#aa167a7f1729c5e12a748dc4011a3039d">Mutex</a> &gt; &amp;lockGuard)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a remote procedure call on the server's <a class="el" href="classLogCabin_1_1Server_1_1RaftService.html">RaftService</a>.  <a href="#ad7c0b6afed998a197d4a538e6a56e589"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a64724bf0a6f9aa79c0e5dfc973d8a195">startThread</a> (std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a> &gt; self)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Launch this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html" title="Represents another server in the cluster.">Peer</a>'s thread, which should run <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html#ac1f0d77d25c59e83ce7c446726292aaa" title="Initiate RPCs to a specific server as necessary.">RaftConsensus::peerThreadMain</a>.  <a href="#a64724bf0a6f9aa79c0e5dfc973d8a195"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad76e79f05ed4e34288bf168ed931a6cd">dumpToStream</a> (std::ostream &amp;os) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual method for operator&lt;&lt;.  <a href="#ad76e79f05ed4e34288bf168ed931a6cd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a8b3a632d179de95c2adafaa5964a411a">updatePeerStats</a> (Protocol::ServerStats::Raft::Peer &amp;peerStats, <a class="el" href="classLogCabin_1_1Core_1_1Time_1_1SteadyTimeConverter.html">Core::Time::SteadyTimeConverter</a> &amp;time) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a>'s state into the given structure.  <a href="#a8b3a632d179de95c2adafaa5964a411a"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html">RaftConsensus</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aab8969e0bf7d7c361908ad13073a6d2d">consensus</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Used in startThread.  <a href="#aab8969e0bf7d7c361908ad13073a6d2d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1Event_1_1Loop.html">Event::Loop</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a2a7df5ec0a4db59fb8c0f0c462fd89ea">eventLoop</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A reference to the server's event loop, needed to construct new sessions.  <a href="#a2a7df5ec0a4db59fb8c0f0c462fd89ea"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#afcc06ccb9c33a32eee1503aa5b1ee205">exiting</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to true when thread should exit.  <a href="#afcc06ccb9c33a32eee1503aa5b1ee205"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ac4a82cf70a21989f2f59505281647c3f">requestVoteDone</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to true if the server has responded to our RequestVote request in the current term, false otherwise.  <a href="#ac4a82cf70a21989f2f59505281647c3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a57b21af23dcbefa804c9c962591e5025">haveVote_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a31e4de7206ec311e2bd8e9f912a284d0" title="Return true if this Server has awarded us its vote for this term.">haveVote()</a>.  <a href="#a57b21af23dcbefa804c9c962591e5025"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a50d0b442ca40959e135e45107a8c6c76">forceHeartbeat</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates that nextIndex is still a (poor) guess: the leader should send heartbeats to save bandwidth until it finds where the follower's log diverges from its own.  <a href="#a50d0b442ca40959e135e45107a8c6c76"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a681aed27116449b0ec7705e85f09fd07">nextIndex</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The index of the next entry to send to the follower.  <a href="#a681aed27116449b0ec7705e85f09fd07"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a2af3be3d3ac5cfb2c79270d084f01e21">lastAgreeIndex</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a74f6a5c2c9950c94cf61c1c302f9d84f" title="Return the largest entry ID for which this Server is known to share the same entries up to and includ...">getLastAgreeIndex()</a>.  <a href="#a2af3be3d3ac5cfb2c79270d084f01e21"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a3ac99d0f0a94203643ac72cf4e4c0e69">lastAckEpoch</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a2a60ec5adc78780464eff2eaaf625d86" title="Return the latest time this Server acknowledged our current term.">getLastAckEpoch()</a>.  <a href="#a3ac99d0f0a94203643ac72cf4e4c0e69"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#a9b2ddcfb6434331d10e3ed84c66e14e3">TimePoint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#af3115d040af27bfe093f1881fd243716">nextHeartbeatTime</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">When the next heartbeat should be sent to the follower.  <a href="#af3115d040af27bfe093f1881fd243716"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#a9b2ddcfb6434331d10e3ed84c66e14e3">TimePoint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a8b6511933a555747a4edf9e4cb9f385c">backoffUntil</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The minimum time at which the next <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> should be sent.  <a href="#a8b6511933a555747a4edf9e4cb9f385c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#af384128771f7e60f485b837114f56788">rpcFailuresSinceLastWarning</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> failures to issue fewer warnings.  <a href="#af384128771f7e60f485b837114f56788"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aa278a1b1f4db199d22db2077dab0bd1f">lastCatchUpIterationMs</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#a9b2ddcfb6434331d10e3ed84c66e14e3">TimePoint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aee6a46284ffbb597bdaaf4171cca5b6a">thisCatchUpIterationStart</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a0b1063ab72094143e3e1acdfb531b355">thisCatchUpIterationGoalId</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aa35915b9016d63af612039b1eea9c9bf">isCaughtUp_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a81973f60b1302672c5d0c582a4638f4b" title="Return true once this Server is ready to be added to the cluster.">isCaughtUp()</a>.  <a href="#aa35915b9016d63af612039b1eea9c9bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="classLogCabin_1_1Storage_1_1FilesystemUtil_1_1FileContents.html">Storage::FilesystemUtil::FileContents</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad26b3c377e98b3ae5f0818b7b76908fd">snapshotFile</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A snapshot file to be sent to the follower, or NULL.  <a href="#ad26b3c377e98b3ae5f0818b7b76908fd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a71e8fe01080a5c648184fcada409c56a">snapshotFileOffset</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of bytes of 'snapshotFile' that have been acknowledged by the follower already.  <a href="#a71e8fe01080a5c648184fcada409c56a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a4a814e3469c1609f999488037a01087c">lastSnapshotIndex</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The last log index that 'snapshotFile' corresponds to.  <a href="#a4a814e3469c1609f999488037a01087c"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::shared_ptr<br class="typebreak"/>
&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a3e688557bfc2d99836ae83fe7ccd8145">getSession</a> (std::unique_lock&lt; <a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#aa167a7f1729c5e12a748dc4011a3039d">Mutex</a> &gt; &amp;lockGuard)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current session for this server.  <a href="#a3e688557bfc2d99836ae83fe7ccd8145"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ae2e3c8a6a03b1234da9acde4e70c09ca">Peer</a> (const <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad48cd427d0243927b231fa740ca85956">operator=</a> (const <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a> &amp;)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::shared_ptr<br class="typebreak"/>
&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a16744a8ac76825923b7bd86625aa26c8">session</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Caches the result of <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a3e688557bfc2d99836ae83fe7ccd8145" title="Get the current session for this server.">getSession()</a>.  <a href="#a16744a8ac76825923b7bd86625aa26c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLogCabin_1_1RPC_1_1ClientRPC.html">RPC::ClientRPC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a6152a1441ad8d36900beae23b8adb231">rpc</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad7c0b6afed998a197d4a538e6a56e589" title="Execute a remote procedure call on the server&#39;s RaftService.">callRPC()</a> places its <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> here so that <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a5daf374d78d59b74c639acef42f8b1e5" title="Cancel any outstanding RPCs to this Server.">interrupt()</a> may cancel it.  <a href="#a6152a1441ad8d36900beae23b8adb231"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Represents another server in the cluster. </p>
<p>One of these exists for each other server. In addition to tracking state for each other server, this class provides a thread that executes <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html#ac1f0d77d25c59e83ce7c446726292aaa" title="Initiate RPCs to a specific server as necessary.">RaftConsensus::peerThreadMain()</a>.</p>
<p>This class has no internal locking: in general, the <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html" title="An implementation of the Raft consensus algorithm.">RaftConsensus</a> lock should be held when accessing this class, but there are some exceptions noted below. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00245">245</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab658a5a52b9183a271843a5279d31ac9"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::Peer" ref="ab658a5a52b9183a271843a5279d31ac9" args="(uint64_t serverId, RaftConsensus &amp;consensus)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ab658a5a52b9183a271843a5279d31ac9">LogCabin::Server::RaftConsensusInternal::Peer::Peer</a> </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>serverId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html">RaftConsensus</a> &amp;&#160;</td>
          <td class="paramname"><em>consensus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00150">150</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a33cb93c3fc8e2aefe48e832b46d27b8f"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::~Peer" ref="a33cb93c3fc8e2aefe48e832b46d27b8f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a33cb93c3fc8e2aefe48e832b46d27b8f">LogCabin::Server::RaftConsensusInternal::Peer::~Peer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00181">181</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ae2e3c8a6a03b1234da9acde4e70c09ca"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::Peer" ref="ae2e3c8a6a03b1234da9acde4e70c09ca" args="(const Peer &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ab658a5a52b9183a271843a5279d31ac9">LogCabin::Server::RaftConsensusInternal::Peer::Peer</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aa7a24ef9188194eefe118684d66a2ec5"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::beginRequestVote" ref="aa7a24ef9188194eefe118684d66a2ec5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aa7a24ef9188194eefe118684d66a2ec5">LogCabin::Server::RaftConsensusInternal::Peer::beginRequestVote</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Begin requesting the <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a>'s vote in the current election. </p>
<p>Return immediately. The condition variable in <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html" title="An implementation of the Raft consensus algorithm.">RaftConsensus</a> will be notified separately. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#aab43402fe28b4fac77a2a53da7f7c779">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00186">186</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ad5ba27d28751c0c5c12e3670f7055afd"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::beginLeadership" ref="ad5ba27d28751c0c5c12e3670f7055afd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad5ba27d28751c0c5c12e3670f7055afd">LogCabin::Server::RaftConsensusInternal::Peer::beginLeadership</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Begin replicating to the <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> in the current term. </p>
<p>Return immediately. The condition variable in <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html" title="An implementation of the Raft consensus algorithm.">RaftConsensus</a> will be notified separately. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#ad03f113b797b25406325dde9bcf78fb2">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00193">193</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a46d99021b75d28c44c31cbe4fe221001"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::exit" ref="a46d99021b75d28c44c31cbe4fe221001" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a46d99021b75d28c44c31cbe4fe221001">LogCabin::Server::RaftConsensusInternal::Peer::exit</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Inform any threads belonging to this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> to exit. </p>
<p>Return immediately. The condition variable in <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html" title="An implementation of the Raft consensus algorithm.">RaftConsensus</a> will be notified separately. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#ae4af8d452636e4d3fada9eb686416143">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00204">204</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a2a60ec5adc78780464eff2eaaf625d86"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::getLastAckEpoch" ref="a2a60ec5adc78780464eff2eaaf625d86" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a2a60ec5adc78780464eff2eaaf625d86">LogCabin::Server::RaftConsensusInternal::Peer::getLastAckEpoch</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the latest time this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> acknowledged our current term. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#a78554a4aaedbe99eca7dbb652b0ba355">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00211">211</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a74f6a5c2c9950c94cf61c1c302f9d84f"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::getLastAgreeIndex" ref="a74f6a5c2c9950c94cf61c1c302f9d84f" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a74f6a5c2c9950c94cf61c1c302f9d84f">LogCabin::Server::RaftConsensusInternal::Peer::getLastAgreeIndex</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the largest entry ID for which this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> is known to share the same entries up to and including this entry with our log. </p>
<p>This is used for advancing the leader's commitIndex. Monotonically increases within a term.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>Only valid when we're leader. </dd></dl>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#ab54a3a7c21b87f7d0b93babbbbc3d00a">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00217">217</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a31e4de7206ec311e2bd8e9f912a284d0"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::haveVote" ref="a31e4de7206ec311e2bd8e9f912a284d0" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a31e4de7206ec311e2bd8e9f912a284d0">LogCabin::Server::RaftConsensusInternal::Peer::haveVote</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return true if this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> has awarded us its vote for this term. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#a0651a28c215025bab21d9617b20544ff">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00223">223</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a81973f60b1302672c5d0c582a4638f4b"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::isCaughtUp" ref="a81973f60b1302672c5d0c582a4638f4b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a81973f60b1302672c5d0c582a4638f4b">LogCabin::Server::RaftConsensusInternal::Peer::isCaughtUp</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return true once this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a> is ready to be added to the cluster. </p>
<p>This means it has received enough of our log to where it is not expected to cause an availability problem when added to the cluster configuration. Should monotonically change from false to true. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#abaabd1bf45eefc51e4d99548a2c71eb1">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00235">235</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a5daf374d78d59b74c639acef42f8b1e5"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::interrupt" ref="a5daf374d78d59b74c639acef42f8b1e5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a5daf374d78d59b74c639acef42f8b1e5">LogCabin::Server::RaftConsensusInternal::Peer::interrupt</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cancel any outstanding RPCs to this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a>. </p>
<p>The condition variable in <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html" title="An implementation of the Raft consensus algorithm.">RaftConsensus</a> will be notified separately. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#af56e0aa8cbf6377047a1737c461e84e9">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00229">229</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a8cf12a4c6290d1ea99c3e4074fced205"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::scheduleHeartbeat" ref="a8cf12a4c6290d1ea99c3e4074fced205" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a8cf12a4c6290d1ea99c3e4074fced205">LogCabin::Server::RaftConsensusInternal::Peer::scheduleHeartbeat</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make the next heartbeat <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> happen soon. </p>
<p>Return immediately. The condition variable in <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html" title="An implementation of the Raft consensus algorithm.">RaftConsensus</a> will be notified separately. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#a33c58fbb1b5f1b39cfd9cd941ab2b153">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00241">241</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ad7c0b6afed998a197d4a538e6a56e589"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::callRPC" ref="ad7c0b6afed998a197d4a538e6a56e589" args="(Protocol::Raft::OpCode opCode, const google::protobuf::Message &amp;request, google::protobuf::Message &amp;response, std::unique_lock&lt; Mutex &gt; &amp;lockGuard)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad7c0b6afed998a197d4a538e6a56e589">LogCabin::Server::RaftConsensusInternal::Peer::callRPC</a> </td>
          <td>(</td>
          <td class="paramtype">Protocol::Raft::OpCode&#160;</td>
          <td class="paramname"><em>opCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const google::protobuf::Message &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">google::protobuf::Message &amp;&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_lock&lt; <a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#aa167a7f1729c5e12a748dc4011a3039d">Mutex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>lockGuard</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Execute a remote procedure call on the server's <a class="el" href="classLogCabin_1_1Server_1_1RaftService.html">RaftService</a>. </p>
<p>As this operation might take a while, it should be called without <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html" title="An implementation of the Raft consensus algorithm.">RaftConsensus</a> lock. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">opCode</td><td>The <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> opcode to execute (see Protocol::Raft::OpCode). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>The request that was received from the other server. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">response</td><td>Where the reply should be placed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lockGuard</td><td>The Raft lock, which is released internally to allow for I/O concurrency. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>True if the <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> succeeded and the response was filled in; false otherwise. </dd></dl>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00247">247</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a64724bf0a6f9aa79c0e5dfc973d8a195"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::startThread" ref="a64724bf0a6f9aa79c0e5dfc973d8a195" args="(std::shared_ptr&lt; Peer &gt; self)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a64724bf0a6f9aa79c0e5dfc973d8a195">LogCabin::Server::RaftConsensusInternal::Peer::startThread</a> </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a> &gt;&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Launch this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html" title="Represents another server in the cluster.">Peer</a>'s thread, which should run <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html#ac1f0d77d25c59e83ce7c446726292aaa" title="Initiate RPCs to a specific server as necessary.">RaftConsensus::peerThreadMain</a>. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>A shared_ptr to this object, which the detached thread uses to make sure this object doesn't go away. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00290">290</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ad76e79f05ed4e34288bf168ed931a6cd"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::dumpToStream" ref="ad76e79f05ed4e34288bf168ed931a6cd" args="(std::ostream &amp;os) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad76e79f05ed4e34288bf168ed931a6cd">LogCabin::Server::RaftConsensusInternal::Peer::dumpToStream</a> </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Virtual method for operator&lt;&lt;. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#a671550310e27d14b8253800119a8ed72">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00318">318</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a8b3a632d179de95c2adafaa5964a411a"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::updatePeerStats" ref="a8b3a632d179de95c2adafaa5964a411a" args="(Protocol::ServerStats::Raft::Peer &amp;peerStats, Core::Time::SteadyTimeConverter &amp;time) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a8b3a632d179de95c2adafaa5964a411a">LogCabin::Server::RaftConsensusInternal::Peer::updatePeerStats</a> </td>
          <td>(</td>
          <td class="paramtype">Protocol::ServerStats::Raft::Peer &amp;&#160;</td>
          <td class="paramname"><em>peerStats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLogCabin_1_1Core_1_1Time_1_1SteadyTimeConverter.html">Core::Time::SteadyTimeConverter</a> &amp;&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write this <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html" title="A base class for known servers in the cluster, including this process (see LocalServer) and others (s...">Server</a>'s state into the given structure. </p>
<p>Used for diagnostics. </p>

<p>Implements <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Server.html#a0c23b36bf393b2c029c31c424f8b7fd8">LogCabin::Server::RaftConsensusInternal::Server</a>.</p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00347">347</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a3e688557bfc2d99836ae83fe7ccd8145"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::getSession" ref="a3e688557bfc2d99836ae83fe7ccd8145" args="(std::unique_lock&lt; Mutex &gt; &amp;lockGuard)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a> &gt; <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a3e688557bfc2d99836ae83fe7ccd8145">LogCabin::Server::RaftConsensusInternal::Peer::getSession</a> </td>
          <td>(</td>
          <td class="paramtype">std::unique_lock&lt; <a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#aa167a7f1729c5e12a748dc4011a3039d">Mutex</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>lockGuard</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the current session for this server. </p>
<p>(This is cached in the <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a16744a8ac76825923b7bd86625aa26c8" title="Caches the result of getSession().">session</a> member for efficiency.) As this operation might take a while, it should be called without <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html" title="An implementation of the Raft consensus algorithm.">RaftConsensus</a> lock. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8cc_source.html#l00300">300</a> of file <a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ad48cd427d0243927b231fa740ca85956"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::operator=" ref="ad48cd427d0243927b231fa740ca85956" args="(const Peer &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a>&amp; LogCabin::Server::RaftConsensusInternal::Peer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html">Peer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aab8969e0bf7d7c361908ad13073a6d2d"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::consensus" ref="aab8969e0bf7d7c361908ad13073a6d2d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1RaftConsensus.html">RaftConsensus</a>&amp; <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aab8969e0bf7d7c361908ad13073a6d2d">LogCabin::Server::RaftConsensusInternal::Peer::consensus</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used in startThread. </p>
<p>TODO(ongaro): reconsider </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00319">319</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2a7df5ec0a4db59fb8c0f0c462fd89ea"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::eventLoop" ref="a2a7df5ec0a4db59fb8c0f0c462fd89ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1Event_1_1Loop.html">Event::Loop</a>&amp; <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a2a7df5ec0a4db59fb8c0f0c462fd89ea">LogCabin::Server::RaftConsensusInternal::Peer::eventLoop</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A reference to the server's event loop, needed to construct new sessions. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00325">325</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="afcc06ccb9c33a32eee1503aa5b1ee205"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::exiting" ref="afcc06ccb9c33a32eee1503aa5b1ee205" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#afcc06ccb9c33a32eee1503aa5b1ee205">LogCabin::Server::RaftConsensusInternal::Peer::exiting</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set to true when thread should exit. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00330">330</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac4a82cf70a21989f2f59505281647c3f"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::requestVoteDone" ref="ac4a82cf70a21989f2f59505281647c3f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ac4a82cf70a21989f2f59505281647c3f">LogCabin::Server::RaftConsensusInternal::Peer::requestVoteDone</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set to true if the server has responded to our RequestVote request in the current term, false otherwise. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00336">336</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a57b21af23dcbefa804c9c962591e5025"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::haveVote_" ref="a57b21af23dcbefa804c9c962591e5025" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a57b21af23dcbefa804c9c962591e5025">LogCabin::Server::RaftConsensusInternal::Peer::haveVote_</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a31e4de7206ec311e2bd8e9f912a284d0" title="Return true if this Server has awarded us its vote for this term.">haveVote()</a>. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00341">341</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a50d0b442ca40959e135e45107a8c6c76"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::forceHeartbeat" ref="a50d0b442ca40959e135e45107a8c6c76" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a50d0b442ca40959e135e45107a8c6c76">LogCabin::Server::RaftConsensusInternal::Peer::forceHeartbeat</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Indicates that nextIndex is still a (poor) guess: the leader should send heartbeats to save bandwidth until it finds where the follower's log diverges from its own. </p>
<p>Only used when leader. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00348">348</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a681aed27116449b0ec7705e85f09fd07"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::nextIndex" ref="a681aed27116449b0ec7705e85f09fd07" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a681aed27116449b0ec7705e85f09fd07">LogCabin::Server::RaftConsensusInternal::Peer::nextIndex</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The index of the next entry to send to the follower. </p>
<p>Only used when leader. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00354">354</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2af3be3d3ac5cfb2c79270d084f01e21"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::lastAgreeIndex" ref="a2af3be3d3ac5cfb2c79270d084f01e21" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a2af3be3d3ac5cfb2c79270d084f01e21">LogCabin::Server::RaftConsensusInternal::Peer::lastAgreeIndex</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a74f6a5c2c9950c94cf61c1c302f9d84f" title="Return the largest entry ID for which this Server is known to share the same entries up to and includ...">getLastAgreeIndex()</a>. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00359">359</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3ac99d0f0a94203643ac72cf4e4c0e69"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::lastAckEpoch" ref="a3ac99d0f0a94203643ac72cf4e4c0e69" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a3ac99d0f0a94203643ac72cf4e4c0e69">LogCabin::Server::RaftConsensusInternal::Peer::lastAckEpoch</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a2a60ec5adc78780464eff2eaaf625d86" title="Return the latest time this Server acknowledged our current term.">getLastAckEpoch()</a>. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00364">364</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="af3115d040af27bfe093f1881fd243716"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::nextHeartbeatTime" ref="af3115d040af27bfe093f1881fd243716" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#a9b2ddcfb6434331d10e3ed84c66e14e3">TimePoint</a> <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#af3115d040af27bfe093f1881fd243716">LogCabin::Server::RaftConsensusInternal::Peer::nextHeartbeatTime</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>When the next heartbeat should be sent to the follower. </p>
<p>Only valid while we're leader. The leader sends heartbeats periodically if it has no new data to send, to stop the follower from starting a new election. </p>
<dl class="invariant"><dt><b>Invariant:</b></dt><dd>This is never more than HEARTBEAT_PERIOD_MS in the future, since new leaders don't reset it. </dd></dl>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00375">375</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8b6511933a555747a4edf9e4cb9f385c"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::backoffUntil" ref="a8b6511933a555747a4edf9e4cb9f385c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#a9b2ddcfb6434331d10e3ed84c66e14e3">TimePoint</a> <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a8b6511933a555747a4edf9e4cb9f385c">LogCabin::Server::RaftConsensusInternal::Peer::backoffUntil</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The minimum time at which the next <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> should be sent. </p>
<p>Only valid while we're a candidate or leader. This is set when an <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> fails so as to not overwhelm the network with retries (some RPCs fail without timing out, for example if the remote kernel rejects the connection). </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00384">384</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="af384128771f7e60f485b837114f56788"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::rpcFailuresSinceLastWarning" ref="af384128771f7e60f485b837114f56788" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#af384128771f7e60f485b837114f56788">LogCabin::Server::RaftConsensusInternal::Peer::rpcFailuresSinceLastWarning</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Counts <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> failures to issue fewer warnings. </p>
<p>Accessed only from <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad7c0b6afed998a197d4a538e6a56e589" title="Execute a remote procedure call on the server&#39;s RaftService.">callRPC()</a> without holding the lock. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00390">390</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa278a1b1f4db199d22db2077dab0bd1f"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::lastCatchUpIterationMs" ref="aa278a1b1f4db199d22db2077dab0bd1f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aa278a1b1f4db199d22db2077dab0bd1f">LogCabin::Server::RaftConsensusInternal::Peer::lastCatchUpIterationMs</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00393">393</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="aee6a46284ffbb597bdaaf4171cca5b6a"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::thisCatchUpIterationStart" ref="aee6a46284ffbb597bdaaf4171cca5b6a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceLogCabin_1_1Server_1_1RaftConsensusInternal.html#a9b2ddcfb6434331d10e3ed84c66e14e3">TimePoint</a> <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aee6a46284ffbb597bdaaf4171cca5b6a">LogCabin::Server::RaftConsensusInternal::Peer::thisCatchUpIterationStart</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00394">394</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0b1063ab72094143e3e1acdfb531b355"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::thisCatchUpIterationGoalId" ref="a0b1063ab72094143e3e1acdfb531b355" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a0b1063ab72094143e3e1acdfb531b355">LogCabin::Server::RaftConsensusInternal::Peer::thisCatchUpIterationGoalId</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00395">395</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa35915b9016d63af612039b1eea9c9bf"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::isCaughtUp_" ref="aa35915b9016d63af612039b1eea9c9bf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#aa35915b9016d63af612039b1eea9c9bf">LogCabin::Server::RaftConsensusInternal::Peer::isCaughtUp_</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>See <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a81973f60b1302672c5d0c582a4638f4b" title="Return true once this Server is ready to be added to the cluster.">isCaughtUp()</a>. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00400">400</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad26b3c377e98b3ae5f0818b7b76908fd"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::snapshotFile" ref="ad26b3c377e98b3ae5f0818b7b76908fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classLogCabin_1_1Storage_1_1FilesystemUtil_1_1FileContents.html">Storage::FilesystemUtil::FileContents</a>&gt; <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad26b3c377e98b3ae5f0818b7b76908fd">LogCabin::Server::RaftConsensusInternal::Peer::snapshotFile</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A snapshot file to be sent to the follower, or NULL. </p>
<p>TODO(ongaro): It'd be better to destroy this as soon as this server steps down, but peers don't have a hook for that right now. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00407">407</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a71e8fe01080a5c648184fcada409c56a"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::snapshotFileOffset" ref="a71e8fe01080a5c648184fcada409c56a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a71e8fe01080a5c648184fcada409c56a">LogCabin::Server::RaftConsensusInternal::Peer::snapshotFileOffset</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The number of bytes of 'snapshotFile' that have been acknowledged by the follower already. </p>
<p>Send starting here next time. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00412">412</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4a814e3469c1609f999488037a01087c"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::lastSnapshotIndex" ref="a4a814e3469c1609f999488037a01087c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a4a814e3469c1609f999488037a01087c">LogCabin::Server::RaftConsensusInternal::Peer::lastSnapshotIndex</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The last log index that 'snapshotFile' corresponds to. </p>
<p>This is used to set the follower's <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a681aed27116449b0ec7705e85f09fd07" title="The index of the next entry to send to the follower.">nextIndex</a> accordingly after we're done sending it the snapshot. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00418">418</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a16744a8ac76825923b7bd86625aa26c8"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::session" ref="a16744a8ac76825923b7bd86625aa26c8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classLogCabin_1_1RPC_1_1ClientSession.html">RPC::ClientSession</a>&gt; <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a16744a8ac76825923b7bd86625aa26c8">LogCabin::Server::RaftConsensusInternal::Peer::session</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Caches the result of <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a3e688557bfc2d99836ae83fe7ccd8145" title="Get the current session for this server.">getSession()</a>. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00425">425</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6152a1441ad8d36900beae23b8adb231"></a><!-- doxytag: member="LogCabin::Server::RaftConsensusInternal::Peer::rpc" ref="a6152a1441ad8d36900beae23b8adb231" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLogCabin_1_1RPC_1_1ClientRPC.html">RPC::ClientRPC</a> <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a6152a1441ad8d36900beae23b8adb231">LogCabin::Server::RaftConsensusInternal::Peer::rpc</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#ad7c0b6afed998a197d4a538e6a56e589" title="Execute a remote procedure call on the server&#39;s RaftService.">callRPC()</a> places its <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> here so that <a class="el" href="classLogCabin_1_1Server_1_1RaftConsensusInternal_1_1Peer.html#a5daf374d78d59b74c639acef42f8b1e5" title="Cancel any outstanding RPCs to this Server.">interrupt()</a> may cancel it. </p>
<p>Setting this member and canceling the <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> must be done while holding the Raft lock; waiting on the <a class="el" href="namespaceLogCabin_1_1RPC.html">RPC</a> is done without holding that lock. </p>

<p>Definition at line <a class="el" href="RaftConsensus_8h_source.html#l00432">432</a> of file <a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Server/<a class="el" href="RaftConsensus_8h_source.html">RaftConsensus.h</a></li>
<li>Server/<a class="el" href="RaftConsensus_8cc_source.html">RaftConsensus.cc</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
